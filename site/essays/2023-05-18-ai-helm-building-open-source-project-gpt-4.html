<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><base href=/><title>AI at the Helm: Building an Entire Open Source Project With GPT-4 | cnr.sh</title><link href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üí¨</text></svg>" rel=icon><link title="Chris Riccomini's RSS Feed" href=/rss.xml rel=alternate type=application/rss+xml><link href=https://fonts.googleapis.com rel=preconnect><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=block" rel=stylesheet><link href=/css/style.css rel=stylesheet><link href=/css/pygments.css rel=stylesheet><script crossorigin src=https://kit.fontawesome.com/672d96e063.js></script><script src="https://www.googletagmanager.com/gtag/js?id=G-3R91BN0RW0" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[];gtag(`js`,new Date());gtag(`config`,`G-3R91BN0RW0`)</script><meta content=summary name=twitter:card><meta content="AI at the Helm: Building an Entire Open Source Project With GPT-4 | cnr.sh" name=twitter:title><meta content="AI at the Helm: Building an Entire Open Source Project With GPT-4 | cnr.sh" property=og:title><meta content=website property=og:type><meta content="I've mostly been a LLM and GPT skeptic. Every so often I'd bang my head against ChatGPT, and it usually gave me junk. I'd wander off grumbling things jaded engineers grumble." name=twitter:description><meta content="I've mostly been a LLM and GPT skeptic. Every so often I'd bang my head against ChatGPT, and it usually gave me junk. I'd wander off grumbling things jaded engineers grumble." property=og:description><body><header><h1><a href=/>cnr.sh</a></h1><nav><ul><li><a href=/talks>Talks</a><li><a href=/404>Oops!</a><li><a href=/essays>Index</a></ul></nav></header><main><p>I've mostly been a <a href=https://en.wikipedia.org/wiki/Large_language_model>LLM</a> and <a href=https://en.wikipedia.org/wiki/Generative_pre-trained_transformer>GPT</a> skeptic. Every so often I'd bang my head against <a href=https://openai.com/blog/chatgpt>ChatGPT</a>, and it usually gave me junk. I'd wander off grumbling things jaded engineers grumble.<p>Then I payed for OpenAI's <a href=https://openai.com/research/gpt-4>GPT-4</a> upgrade. GPT-4 actually seemed to work, so I decided to see how far I could push it. Could I write an entire open source project with GPT-4? Turns out, I could.<p>I had GPT-4 build me <a href=https://github.com/criccomini/twister>Twister</a>, a Java library that converts Avro and Protobuf data to and from Java POJOs. Nearly every element--code, docs, commit messages, tests, its README.md, even this blog post--was written by GPT-4.<p>This post isn't about Twister, though. It's about how I learned to use ChatGPT effectively to write not just tests and documentation, but code.<h2>Key Lessons from Building with GPT-4</h2><p>Here's what I learned:<ul><li><strong>Start Small</strong>: Don't aim for complex features right away.<li><strong>Code, Test, Repeat</strong>: Follow the same patterns you use to write code.<li><strong>GPT-4 Forgets</strong>: Always re-paste the code you want to update.<li><strong>Show Changes Only</strong>: Helps you get answers faster. GPT-4 can be slow.<li><strong>Iterate</strong>: Don't write GPT-4 off at first mistake. Keep asking it to correct.<li><strong>Great for Grunt Work</strong>: GPT-4 shines with tests, docs, and commit messages.<li><strong>Best for 'Pure' Projects</strong>: Less business logic, like Twister, suits GPT-4.<li><strong>Keep GPT-3.5 Handy</strong>: Good for simpler tasks. Saves on GPT-4 quota.</ul><h3>Start Small</h3><p>Break down tasks. Ask GPT-4 to build simple code changes at first. With Twister, I would have it build support for basic primitives (int, float, string, etc.) first. Once I got that working, I'd ask it to add support for complex types (maps, lists, enums, etc.).<h3>Code, Test, Repeat</h3><p>The best pattern I found was:<ol><li>Ask GPT-4 to write code.<li>Ask GPT-4 to write a test for the code it'd written.<li>Ask GPT-4 to fix the failed test(s) if they don't pass.</ol><p>Flipping 1 and 2 (<a href=https://en.wikipedia.org/wiki/Test-driven_development>TDD</a>) works, too<p>If you spot bugs, ask it to write tests exposing the bug. Then ask it to fix the test. The template I used for this loop was:<pre><code>Given this code:
...

And this test:
...

I get this error:
...

Can you fix this?
</code></pre><h3>GPT-4 Forgets</h3><p>GPT-4 has a bad long-term memory. I found it did much better when I kept re-pasting my code into the prompt on ever iteration. There is a limit to the input size, so you have to get creative sometimes to fit relevant snippets in.<h3>Show Changes Only</h3><p>GPT-4 can be slow. To speed it up, request that it shows you only the code that's changed.<h3>Iterate</h3><p>Don't dismiss GPT-4 at first error, even if it says silly things. Ask for corrections.<h3>Great for Grunt Work</h3><p>GPT-4 excels at mundane tasks. I'm convinced everyone should use it for tests, doc strings, and commit messages.<h3>Best for 'Pure' Projects</h3><p>Twister is a pretty pure computer science project; there isn't any real "business logic". I think GPT-4 does better at this kind of work.<h3>Keep GPT-3.5 Handy</h3><p>Use GPT-3.5 for simpler tasks. Saves you on your GPT-4 quota.<h2>Why Not Github Copilot?</h2><p>Copilot employs GPT-3.5. Compared to GPT-4, it is noticeably less effective. Copilot X offers improvements, yet it's tied to VisualStudio and VSCode. However, IntelliJ IDE is way more pleasant for Java than VSCode. So I just used ChatGPT. In the long run, IDE integration will certainly improve. Yet, for now, GPT-4 offered the optimal solution for Twister.<h2>Future work</h2><p>The Twister library is a small project right now. I want to add:<ul><li>Avro default support<li>Avro logical type support<li>Protobuf WKT support<li>Avro Record ‚û°Ô∏è Map wrapper<li>Protobuf Message ‚û°Ô∏è Map wrapper<li>.proto ‚û°Ô∏è Protobuf Descriptor converter<li>JDBC row ‚û°Ô∏è Map wrapper</ul><p>I'll continue having GPT write the code in this library. The experiment continues!<h2>Conclusion</h2><p>Though this post is about building with GPT-4, I want to re-iterate that <a href=https://github.com/criccomini/twister>Twister</a> is a real project that I actually want people to use. It's a pretty cool library. If you're a Java developer dealing with Protobuf or Avro, check it out! Contributions are welcome, too (whether from GPT-4 or humans).<h2>Addendum</h2><p>Here's the prompt I used to generate this blog post:<blockquote><p>The blog post should focus on my experience using GPT-4 to write an entire library.<p>The post should also talk about GPT-4 tricks I learned while building this project:<ul><li>Start small (don't ask GPT-4 to write all features in a class at once)<li>Ask GPT for a basic class, then ask it to write a test for the class. If the tests fail, tell GPT, and have it fix the tests. Then go back to the basic class and ask GPT-4 to add the next feature. Rinse and repeat.<li>Always re-paste the code you want GPT-4 to update. It has bad long-term memory. I frequently use a 2 part template: "Given this code: ... Can you update it to ..."<li>Tell it to just show changes, not the complete code. GPT-4 is slow, so telling it to skip unchanged code helps get you answers faster.<li>Don't be afraid to iterate. Many people get a response from GPT-4, and if it's wrong, they declare that it sucks. Instead, keep asking it to fix things.<li>GPT-4 is really good for grunt work (tests, docs, commit messages)<li>GPT-4 is also really good for more "pure" projects like Twister, where it doesn't have to understand a lot of business logic.<li>Keep a GPT-4 and a GPT-3.5 window open, so you can bounce to the GPT-3.5 window for more simple work. This will save you on your GPT-4 quota (currently 25 prompts per-3h window).</ul><p>The blog post style should be:<ol><li>Matter-of-fact.<li>No sentence should be more than 12 words.<li>Include links to external sites where appropriate.<li>Written in first-person.<li>The post should include a bullet-point list of the tips near the introduction.<li>The post should be written in markdown.<li>The post should include a catchy title that will get attention on Hacker news.<li>The post should include a section for each bullet point in the intro.<li>The intro should say that the the code, docs, git commit messages, tests, README.md, and even this blog post were all written with GPT-4.</ol></blockquote><p>I pasted in an rough outline with some notes before this prompt.</main>